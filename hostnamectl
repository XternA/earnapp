#!/bin/sh
# Minimal fake hostnamectl for EarnApp without needing full systemd

run_machine_id() {
    if [ -n "$EARNAPP_UUID" ]; then
        echo "$EARNAPP_UUID" | md5sum | cut -c1-32 > /etc/machine-id
    else
        [ ! -f /etc/machine-id ] && LC_ALL=C tr -dc 'a-f0-9' </dev/urandom | dd bs=1 count=32 2>/dev/null >/etc/machine-id
    fi
}

run_hostnamectl() {
    echo "   Static hostname: $(hostname)"
    echo "         Icon name: computer-vm"
    echo "           Chassis: vm"
    echo "        Machine ID: $(cat /etc/machine-id 2>/dev/null || echo 0000000000000000)"
    echo "           Boot ID: $(cat /proc/sys/kernel/random/boot_id 2>/dev/null || echo 00000000-0000-0000-0000-000000000000)"
    echo "  Virtualization: $(grep -q docker /proc/1/cgroup 2>/dev/null && echo docker || echo none)"
    echo " Operating System: $(grep '^PRETTY_NAME=' /etc/os-release 2>/dev/null | cut -d= -f2- | tr -d '"')"
    echo "      Kernel: $(uname -r)"
    echo "Architecture: $(uname -m)"
}

case "$1" in
    --uuid) run_machine_id ;;
    *) run_hostnamectl ;;
esac